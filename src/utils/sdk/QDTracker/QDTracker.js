'use strict';var __assign=function(){return(__assign=Object.assign||function(e){for(var t, n=1, i=arguments.length;n<i;n++){for(let r in t=arguments[n]){Object.prototype.hasOwnProperty.call(t, r)&&(e[r]=t[r]);}}return e;}).apply(this, arguments);};function __rest(e, t){let n={};for(var i in e){Object.prototype.hasOwnProperty.call(e, i)&&t.indexOf(i)<0&&(n[i]=e[i]);}if(null!=e&&'function'===typeof Object.getOwnPropertySymbols){for(var r=0, i=Object.getOwnPropertySymbols(e);r<i.length;r++){t.indexOf(i[r])<0&&(n[i[r]]=e[i[r]]);}}return n;}let class2type={}, toString=class2type.toString, hasOwn=class2type.hasOwnProperty;function type(e){return null==e?e+'':'object'===typeof e||'function'===typeof e?class2type[toString.call(e)]||'object':typeof e;}function isFunction(e){return'function'===type(e);}function isArray(e){return Array.isArray?Array.isArray(e):'array'===type(e);}function isPlainObject(e){let t;if(!e||'object'!==type(e)){return!1;}try{if(e.constructor&&!hasOwn.call(e, 'constructor')&&!hasOwn.call(e.constructor.prototype, 'isPrototypeOf')){return!1;}}catch(e){return!1;}for(t in e){}return void 0===t||hasOwn.call(e, t);}function extend(){for(var e=[], t=0;t<arguments.length;t++){e[t]=arguments[t];}let n, i, r, a, o, s, c=e[0]||{}, u=1, f=e.length, d=!1;for('boolean'===typeof c&&(d=c, c=e[u]||{}, u++), 'object'!==typeof c&&isFunction(c)&&(c={});u<f;u++){if(null!=(o=e[u])){for(a in o){n=c[a], c!==(r=o[a])&&(d&&r&&(isPlainObject(r)||(i=isArray(r)))?(s=i?(i=!1, n&&isArray(n)?n:[]):n&&isPlainObject(n)?n:{}, c[a]=extend(d, s, r)):void 0!==r&&(c[a]=r));}}}return c;}function isJSONString(e){try{JSON.parse(e);}catch(e){return!1;}return!0;}let EventType, log={debug:!1, init:function(e){this.debug=e.config.debug;}, log:function(e){this.debug&&console.log(e);}, info:function(e){this.debug&&console.info(e);}, error:function(e){this.debug&&console.error(e);}}, localStorage={data:{openid:'', systemInfo:null, qid:''}, init:function(){try{let e=wx.getStorageSync('__QDTracker__');e?isJSONString(e)&&(this.data=JSON.parse(e)):wx.setStorageSync('__QDTracker__', JSON.stringify({}));}catch(e){log.error(e);}}, setValue:function(e, t){this.data[e]=t;}, getValue:function(e){return this.data[e]||'';}, getCache:function(){return this.data;}, save:function(){try{return wx.setStorageSync('__QDTracker__', JSON.stringify(this.data)), !0;}catch(e){return log.error(e), !1;}}}, Base64={_keyStr:'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=', encode:function(e){let t, n, i, r, a, o, s, c='', u=0;for(e=this._utf16to8(e);u<e.length;){r=(t=e.charCodeAt(u++))>>2, a=(3&t)<<4|(n=e.charCodeAt(u++))>>4, o=(15&n)<<2|(i=e.charCodeAt(u++))>>6, s=63&i, isNaN(n)?o=s=64:isNaN(i)&&(s=64), c=c+this._keyStr.charAt(r)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(s);}return c;}, decode:function(e){let t, n, i, r, a, o, s='', c=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g, '');c<e.length;){t=this._keyStr.indexOf(e.charAt(c++))<<2|(r=this._keyStr.indexOf(e.charAt(c++)))>>4, n=(15&r)<<4|(a=this._keyStr.indexOf(e.charAt(c++)))>>2, i=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(c++))), s+=String.fromCharCode(t), 64!=a&&(s+=String.fromCharCode(n)), 64!=o&&(s+=String.fromCharCode(i));}return this._utf8to16(s);}, _utf16to8:function(e){for(var t, n='', i=e.length, r=0;r<i;r++){1<=(t=e.charCodeAt(r))&&t<=127?n+=e.charAt(r):(2047<t?(n+=String.fromCharCode(224|t>>12&15), n+=String.fromCharCode(128|t>>6&63)):n+=String.fromCharCode(192|t>>6&31), n+=String.fromCharCode(128|t>>0&63));}return n;}, _utf8to16:function(e){for(var t, n, i, r='', a=e.length, o=0;o<a;){switch((t=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:r+=e.charAt(o-1);break;case 12:case 13:n=e.charCodeAt(o++), r+=String.fromCharCode((31&t)<<6|63&n);break;case 14:n=e.charCodeAt(o++), i=e.charCodeAt(o++), r+=String.fromCharCode((15&t)<<12|(63&n)<<6|(63&i)<<0);}}return r;}}, __qq_qidian_da_market_AES_method=function(s){function n(){}var e={}, t=e.lib={}, i=t.Base={extend:function(e){n.prototype=this;let t=new n;return e&&t.mixIn(e), t.hasOwnProperty('init')||(t.init=function(){t.$super.init.apply(this, arguments);}), (t.init.prototype=t).$super=this, t;}, create:function(){let e=this.extend();return e.init.apply(e, arguments), e;}, init:function(){}, mixIn:function(e){for(let t in e){e.hasOwnProperty(t)&&(this[t]=e[t]);}e.hasOwnProperty('toString')&&(this.toString=e.toString);}, clone:function(){return this.init.prototype.extend(this);}}, c=t.WordArray=i.extend({init:function(e, t){e=this.words=e||[], this.sigBytes=null!=t?t:4*e.length;}, toString:function(e){return(e||a).stringify(this);}, concat:function(e){let t=this.words, n=e.words, i=this.sigBytes;if(e=e.sigBytes, this.clamp(), i%4){for(var r=0;r<e;r++){t[i+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;}}else if(65535<n.length){for(r=0;r<e;r+=4){t[i+r>>>2]=n[r>>>2];}}else {t.push.apply(t, n);}return this.sigBytes+=e, this;}, clamp:function(){let e=this.words, t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8, e.length=s.ceil(t/4);}, clone:function(){let e=i.clone.call(this);return e.words=this.words.slice(0), e;}, random:function(e){for(var t=[], n=0;n<e;n+=4){t.push(4294967296*s.random()|0);}return new c.init(t, e);}}), r=e.enc={}, a=r.Hex={stringify:function(e){let t=e.words;e=e.sigBytes;for(var n=[], i=0;i<e;i++){let r=t[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)), n.push((15&r).toString(16));}return n.join('');}, parse:function(e){for(var t=e.length, n=[], i=0;i<t;i+=2){n[i>>>3]|=parseInt(e.substr(i, 2), 16)<<24-i%8*4;}return new c.init(n, t/2);}}, o=r.Latin1={stringify:function(e){let t=e.words;e=e.sigBytes;for(var n=[], i=0;i<e;i++){n.push(String.fromCharCode(t[i>>>2]>>>24-i%4*8&255));}return n.join('');}, parse:function(e){for(var t=e.length, n=[], i=0;i<t;i++){n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;}return new c.init(n, t);}}, u=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(o.stringify(e)));}catch(e){throw Error('Malformed UTF-8 data');}}, parse:function(e){return o.parse(unescape(encodeURIComponent(e)));}}, f=t.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new c.init, this._nDataBytes=0;}, _append:function(e){'string'===typeof e&&(e=u.parse(e)), this._data.concat(e), this._nDataBytes+=e.sigBytes;}, _process:function(e){let t=this._data, n=t.words, i=t.sigBytes, r=this.blockSize, a=i/(4*r);if(e=(a=e?s.ceil(a):s.max((0|a)-this._minBufferSize, 0))*r, i=s.min(4*e, i), e){for(var o=0;o<e;o+=r){this._doProcessBlock(n, o);}o=n.splice(0, e), t.sigBytes-=i;}return new c.init(o, i);}, clone:function(){let e=i.clone.call(this);return e._data=this._data.clone(), e;}, _minBufferSize:0});t.Hasher=f.extend({cfg:i.extend(), init:function(e){this.cfg=this.cfg.extend(e), this.reset();}, reset:function(){f.reset.call(this), this._doReset();}, update:function(e){return this._append(e), this._process(), this;}, finalize:function(e){return e&&this._append(e), this._doFinalize();}, blockSize:16, _createHelper:function(n){return function(e, t){return new n.init(t).finalize(e);};}, _createHmacHelper:function(n){return function(e, t){return new d.HMAC.init(n, t).finalize(e);};}});var d=e.algo={};return e;}(Math), getAes=function(){let c, e, t, n, u, i;return c=__qq_qidian_da_market_AES_method.lib.WordArray, __qq_qidian_da_market_AES_method.enc.Base64={stringify:function(e){let t=e.words, n=e.sigBytes, i=this._map;e.clamp(), e=[];for(let r=0;r<n;r+=3){for(let a=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255, o=0;o<4&&r+.75*o<n;o++){e.push(i.charAt(a>>>6*(3-o)&63));}}if(t=i.charAt(64)){for(;e.length%4;){e.push(t);}}return e.join('');}, parse:function(e){let t=e.length, n=this._map;!(a=n.charAt(64))||-1!=(a=e.indexOf(a))&&(t=a);for(var i, r, a=[], o=0, s=0;s<t;s++){s%4&&(i=n.indexOf(e.charAt(s-1))<<s%4*2, r=n.indexOf(e.charAt(s))>>>6-s%4*2, a[o>>>2]|=(i|r)<<24-o%4*8, o++);}return c.create(a, o);}, _map:'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='}, function(a){function q(e, t, n, i, r, a, o){return((e=e+(t&n|~t&i)+r+o)<<a|e>>>32-a)+t;}function w(e, t, n, i, r, a, o){return((e=e+(t&i|n&~i)+r+o)<<a|e>>>32-a)+t;}function x(e, t, n, i, r, a, o){return((e=e+(t^n^i)+r+o)<<a|e>>>32-a)+t;}function E(e, t, n, i, r, a, o){return((e=e+(n^(t|~i))+r+o)<<a|e>>>32-a)+t;}for(var e=__qq_qidian_da_market_AES_method, t=(i=e.lib).WordArray, n=i.Hasher, i=e.algo, A=[], r=0;r<64;r++){A[r]=4294967296*a.abs(a.sin(r+1))|0;}i=i.MD5=n.extend({_doReset:function(){this._hash=new t.init([1732584193, 4023233417, 2562383102, 271733878]);}, _doProcessBlock:function(e, t){for(var n=0;n<16;n++){var i=e[r=t+n];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);}var n=this._hash.words, r=e[t+0], i=e[t+1], a=e[t+2], o=e[t+3], s=e[t+4], c=e[t+5], u=e[t+6], f=e[t+7], d=e[t+8], h=e[t+9], g=e[t+10], p=e[t+11], l=e[t+12], _=e[t+13], y=e[t+14], v=e[t+15], C=q(C=n[0], k=n[1], S=n[2], m=n[3], r, 7, A[0]), m=q(m, C, k, S, i, 12, A[1]), S=q(S, m, C, k, a, 17, A[2]), k=q(k, S, m, C, o, 22, A[3]), C=q(C, k, S, m, s, 7, A[4]), m=q(m, C, k, S, c, 12, A[5]), S=q(S, m, C, k, u, 17, A[6]), k=q(k, S, m, C, f, 22, A[7]), C=q(C, k, S, m, d, 7, A[8]), m=q(m, C, k, S, h, 12, A[9]), S=q(S, m, C, k, g, 17, A[10]), k=q(k, S, m, C, p, 22, A[11]), C=q(C, k, S, m, l, 7, A[12]), m=q(m, C, k, S, _, 12, A[13]), S=q(S, m, C, k, y, 17, A[14]), C=w(C, k=q(k, S, m, C, v, 22, A[15]), S, m, i, 5, A[16]), m=w(m, C, k, S, u, 9, A[17]), S=w(S, m, C, k, p, 14, A[18]), k=w(k, S, m, C, r, 20, A[19]), C=w(C, k, S, m, c, 5, A[20]), m=w(m, C, k, S, g, 9, A[21]), S=w(S, m, C, k, v, 14, A[22]), k=w(k, S, m, C, s, 20, A[23]), C=w(C, k, S, m, h, 5, A[24]), m=w(m, C, k, S, y, 9, A[25]), S=w(S, m, C, k, o, 14, A[26]), k=w(k, S, m, C, d, 20, A[27]), C=w(C, k, S, m, _, 5, A[28]), m=w(m, C, k, S, a, 9, A[29]), S=w(S, m, C, k, f, 14, A[30]), C=x(C, k=w(k, S, m, C, l, 20, A[31]), S, m, c, 4, A[32]), m=x(m, C, k, S, d, 11, A[33]), S=x(S, m, C, k, p, 16, A[34]), k=x(k, S, m, C, y, 23, A[35]), C=x(C, k, S, m, i, 4, A[36]), m=x(m, C, k, S, s, 11, A[37]), S=x(S, m, C, k, f, 16, A[38]), k=x(k, S, m, C, g, 23, A[39]), C=x(C, k, S, m, _, 4, A[40]), m=x(m, C, k, S, r, 11, A[41]), S=x(S, m, C, k, o, 16, A[42]), k=x(k, S, m, C, u, 23, A[43]), C=x(C, k, S, m, h, 4, A[44]), m=x(m, C, k, S, l, 11, A[45]), S=x(S, m, C, k, v, 16, A[46]), C=E(C, k=x(k, S, m, C, a, 23, A[47]), S, m, r, 6, A[48]), m=E(m, C, k, S, f, 10, A[49]), S=E(S, m, C, k, y, 15, A[50]), k=E(k, S, m, C, c, 21, A[51]), C=E(C, k, S, m, l, 6, A[52]), m=E(m, C, k, S, o, 10, A[53]), S=E(S, m, C, k, g, 15, A[54]), k=E(k, S, m, C, i, 21, A[55]), C=E(C, k, S, m, d, 6, A[56]), m=E(m, C, k, S, v, 10, A[57]), S=E(S, m, C, k, u, 15, A[58]), k=E(k, S, m, C, _, 21, A[59]), C=E(C, k, S, m, s, 6, A[60]), m=E(m, C, k, S, p, 10, A[61]), S=E(S, m, C, k, a, 15, A[62]), k=E(k, S, m, C, h, 21, A[63]);n[0]=n[0]+C|0, n[1]=n[1]+k|0, n[2]=n[2]+S|0, n[3]=n[3]+m|0;}, _doFinalize:function(){let e=this._data, t=e.words, n=8*this._nDataBytes, i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32;let r=a.floor(n/4294967296);for(t[15+(64+i>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8), t[14+(64+i>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8), e.sigBytes=4*(t.length+1), this._process(), t=(e=this._hash).words, n=0;n<4;n++){i=t[n], t[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);}return e;}, clone:function(){let e=n.clone.call(this);return e._hash=this._hash.clone(), e;}}), e.MD5=n._createHelper(i), e.HmacMD5=n._createHmacHelper(i);}(Math), t=(e=__qq_qidian_da_market_AES_method).lib, n=t.Base, u=t.WordArray, i=(t=e.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4, hasher:t.MD5, iterations:1}), init:function(e){this.cfg=this.cfg.extend(e);}, compute:function(e, t){for(var n=(o=this.cfg).hasher.create(), i=u.create(), r=i.words, a=o.keySize, o=o.iterations;r.length<a;){s&&n.update(s);var s=n.update(e).finalize(t);n.reset();for(let c=1;c<o;c++){s=n.finalize(s), n.reset();}i.concat(s);}return i.sigBytes=4*a, i;}}), e.EvpKDF=function(e, t, n){return i.create(n).compute(e, t);}, __qq_qidian_da_market_AES_method.lib.Cipher||function(){let e=(h=__qq_qidian_da_market_AES_method).lib, t=e.Base, o=e.WordArray, n=e.BufferedBlockAlgorithm, i=h.enc.Base64, r=h.algo.EvpKDF, a=e.Cipher=n.extend({cfg:t.extend(), createEncryptor:function(e, t){return this.create(this._ENC_XFORM_MODE, e, t);}, createDecryptor:function(e, t){return this.create(this._DEC_XFORM_MODE, e, t);}, init:function(e, t, n){this.cfg=this.cfg.extend(n), this._xformMode=e, this._key=t, this.reset();}, reset:function(){n.reset.call(this), this._doReset();}, process:function(e){return this._append(e), this._process();}, finalize:function(e){return e&&this._append(e), this._doFinalize();}, keySize:4, ivSize:4, _ENC_XFORM_MODE:1, _DEC_XFORM_MODE:2, _createHelper:function(i){return{encrypt:function(e, t, n){return('string'===typeof t?g:d).encrypt(i, e, t, n);}, decrypt:function(e, t, n){return('string'===typeof t?g:d).decrypt(i, e, t, n);}};}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0);}, blockSize:1});function s(e, t, n){let i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(let r=0;r<n;r++){e[t+r]^=i[r];}}var c=h.mode={}, u=(e.BlockCipherMode=t.extend({createEncryptor:function(e, t){return this.Encryptor.create(e, t);}, createDecryptor:function(e, t){return this.Decryptor.create(e, t);}, init:function(e, t){this._cipher=e, this._iv=t;}})).extend();u.Encryptor=u.extend({processBlock:function(e, t){let n=this._cipher, i=n.blockSize;s.call(this, e, t, i), n.encryptBlock(e, t), this._prevBlock=e.slice(t, t+i);}}), u.Decryptor=u.extend({processBlock:function(e, t){let n=this._cipher, i=n.blockSize, r=e.slice(t, t+i);n.decryptBlock(e, t), s.call(this, e, t, i), this._prevBlock=r;}}), c=c.CBC=u, u=(h.pad={}).Pkcs7={pad:function(e, t){for(var n=4*t, i=(n=n-e.sigBytes%n)<<24|n<<16|n<<8|n, r=[], a=0;a<n;a+=4){r.push(i);}n=o.create(r, n), e.concat(n);}, unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2];}}, e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c, padding:u}), reset:function(){a.reset.call(this);var e, t=(n=this.cfg).iv, n=n.mode;this._xformMode==this._ENC_XFORM_MODE?e=n.createEncryptor:(e=n.createDecryptor, this._minBufferSize=1), this._mode=e.call(n, this, t&&t.words);}, _doProcessBlock:function(e, t){this._mode.processBlock(e, t);}, _doFinalize:function(){let e, t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data, this.blockSize), e=this._process(!0)):(e=this._process(!0), t.unpad(e)), e;}, blockSize:4});var f=e.CipherParams=t.extend({init:function(e){this.mixIn(e);}, toString:function(e){return(e||this.formatter).stringify(this);}}), c=(h.format={}).OpenSSL={stringify:function(e){let t=e.ciphertext;return((e=e.salt)?o.create([1398893684, 1701076831]).concat(e).concat(t):t).toString(i);}, parse:function(e){let t, n=(e=i.parse(e)).words;return 1398893684==n[0]&&1701076831==n[1]&&(t=o.create(n.slice(2, 4)), n.splice(0, 4), e.sigBytes-=16), f.create({ciphertext:e, salt:t});}}, d=e.SerializableCipher=t.extend({cfg:t.extend({format:c}), encrypt:function(e, t, n, i){i=this.cfg.extend(i);let r=e.createEncryptor(n, i);return t=r.finalize(t), r=r.cfg, f.create({ciphertext:t, key:n, iv:r.iv, algorithm:e, mode:r.mode, padding:r.padding, blockSize:e.blockSize, formatter:i.format});}, decrypt:function(e, t, n, i){return i=this.cfg.extend(i), t=this._parse(t, i.format), e.createDecryptor(n, i).finalize(t.ciphertext);}, _parse:function(e, t){return'string'===typeof e?t.parse(e, this):e;}}), h=(h.kdf={}).OpenSSL={execute:function(e, t, n, i){return i=i||o.random(8), e=r.create({keySize:t+n}).compute(e, i), n=o.create(e.words.slice(t), 4*n), e.sigBytes=4*t, f.create({key:e, iv:n, salt:i});}}, g=e.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:h}), encrypt:function(e, t, n, i){return n=(i=this.cfg.extend(i)).kdf.execute(n, e.keySize, e.ivSize), i.iv=n.iv, (e=d.encrypt.call(this, e, t, n.key, i)).mixIn(n), e;}, decrypt:function(e, t, n, i){return i=this.cfg.extend(i), t=this._parse(t, i.format), n=i.kdf.execute(n, e.keySize, e.ivSize, t.salt), i.iv=n.iv, d.decrypt.call(this, e, t, n.key, i);}});}(), function(){for(var e=__qq_qidian_da_market_AES_method, t=e.lib.BlockCipher, n=e.algo, o=[], i=[], r=[], a=[], s=[], c=[], u=[], f=[], d=[], h=[], g=[], p=0;p<256;p++){g[p]=p<128?p<<1:p<<1^283;}for(var l=0, _=0, p=0;p<256;p++){var y=(y=_^_<<1^_<<2^_<<3^_<<4)>>>8^255&y^99;o[l]=y;let v=g[i[y]=l], C=g[v], m=g[C], S=257*g[y]^16843008*y;r[l]=S<<24|S>>>8, a[l]=S<<16|S>>>16, s[l]=S<<8|S>>>24, c[l]=S, S=16843009*m^65537*C^257*v^16843008*l, u[y]=S<<24|S>>>8, f[y]=S<<16|S>>>16, d[y]=S<<8|S>>>24, h[y]=S, l?(l=v^g[g[g[m^v]]], _^=g[g[_]]):l=_=1;}var k=[0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54], n=n.AES=t.extend({_doReset:function(){for(var e, t=(i=this._key).words, n=i.sigBytes/4, i=4*((this._nRounds=n+6)+1), r=this._keySchedule=[], a=0;a<i;a++){a<n?r[a]=t[a]:(e=r[a-1], a%n?6<n&&4==a%n&&(e=o[e>>>24]<<24|o[e>>>16&255]<<16|o[e>>>8&255]<<8|o[255&e]):(e=o[(e=e<<8|e>>>24)>>>24]<<24|o[e>>>16&255]<<16|o[e>>>8&255]<<8|o[255&e], e^=k[a/n|0]<<24), r[a]=r[a-n]^e);}for(t=this._invKeySchedule=[], n=0;n<i;n++){a=i-n, e=n%4?r[a]:r[a-4], t[n]=n<4||a<=4?e:u[o[e>>>24]]^f[o[e>>>16&255]]^d[o[e>>>8&255]]^h[o[255&e]];}}, encryptBlock:function(e, t){this._doCryptBlock(e, t, this._keySchedule, r, a, s, c, o);}, decryptBlock:function(e, t){let n=e[t+1];e[t+1]=e[t+3], e[t+3]=n, this._doCryptBlock(e, t, this._invKeySchedule, u, f, d, h, i), n=e[t+1], e[t+1]=e[t+3], e[t+3]=n;}, _doCryptBlock:function(e, t, n, i, r, a, o, s){for(var c=this._nRounds, u=e[t]^n[0], f=e[t+1]^n[1], d=e[t+2]^n[2], h=e[t+3]^n[3], g=4, p=1;p<c;p++){var l=i[u>>>24]^r[f>>>16&255]^a[d>>>8&255]^o[255&h]^n[g++], _=i[f>>>24]^r[d>>>16&255]^a[h>>>8&255]^o[255&u]^n[g++], y=i[d>>>24]^r[h>>>16&255]^a[u>>>8&255]^o[255&f]^n[g++], h=i[h>>>24]^r[u>>>16&255]^a[f>>>8&255]^o[255&d]^n[g++], u=l, f=_, d=y;}l=(s[u>>>24]<<24|s[f>>>16&255]<<16|s[d>>>8&255]<<8|s[255&h])^n[g++], _=(s[f>>>24]<<24|s[d>>>16&255]<<16|s[h>>>8&255]<<8|s[255&u])^n[g++], y=(s[d>>>24]<<24|s[h>>>16&255]<<16|s[u>>>8&255]<<8|s[255&f])^n[g++], h=(s[h>>>24]<<24|s[u>>>16&255]<<16|s[f>>>8&255]<<8|s[255&d])^n[g++], e[t]=l, e[t+1]=_, e[t+2]=y, e[t+3]=h;}, keySize:8});e.AES=t._createHelper(n);}(), __qq_qidian_da_market_AES_method;}, queue={data:{queue:[], openid:'', instance:{}}, init:function(e){this.data.instance=e;}, send:function(e){this.canSend()?(e.data.kfuin||this.data.instance.getConfig('kfuin')&&(e.data.kfuin=this.data.instance.getConfig('kfuin')), e.data.appkey||this.data.instance.getConfig('appkey')&&(e.data.appkey=this.data.instance.getConfig('appkey')), this.data.instance.send(e.url, e.data, e.callback)):this.data.queue.push(e);}, push:function(e){this.data.queue.push(e);}, canSend:function(){return this.data.instance.canSend();}, flush:function(){if(this.canSend()){for(;0<this.data.queue.length;){let e=this.data.queue.shift();this.send(e);}}}}, base36=function(e){return e.toString(36);}, hash=function(e){var t=1;if(e){for(var n, t=0, i=e.length-1;0<=i;i--){t=0!=(n=266338304&(t=(t<<6&268435455)+(n=e.charCodeAt(i))+(n<<14)))?t^n>>21:t;}}return t;}, randomNum=function(){return Math.floor(2147483648*Math.random());}, uuid=function(){return randomNum().toString(36);}, randomId=function(){return(Math.floor(10*Math.random())||1)+function(e, t){let n, i, r='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''), a=[];if(t=t||r.length, e){for(n=0;n<e;n++){a[n]=r[0|Math.random()*t];}}else {for(a[8]=a[13]=a[18]=a[23]='-', a[14]='4', n=0;n<36;n++){a[n]||(i=0|16*Math.random(), a[n]=r[19==n?3&i|8:i]);}}return a.join('');}(3, 10)+(new Date).getTime().toString().slice(2, 13);}, createQid=function(e){let t=base36(randomNum()^2147483647&hash(e))+'.';return base36(+new Date)+'.'+t+uuid();};function eventProxy(e, t, n){let i;e[t]?(i=e[t], e[t]=function(e){try{n.call(this, e, t);}catch(e){console.log('qidianDA_Error', 'eventProxy', e);}i.call(this, e);}):e[t]=function(e){n.call(this, e, t);};}function appLaunch(r){return function(t){let e=['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term'], n=!1, i=localStorage.getCache();e.forEach(function(e){r.setConfig(e, t.query[e]||''), r.setConfig('$latest_'+e, i['$latest_'+e]||''), t.query[e]&&(n=!0);}), n&&e.forEach(function(e){localStorage.setValue('$latest_'+e, t.query[e]||''), r.setConfig('$latest_'+e, t.query[e]||'');}), localStorage.save(), r.setConfig('launchInfo', t), (this.QDTracker=r).getConfig('autoTrack').appLaunch&&r._track(EventType.LAUNCH);};}function appShow(e){return function(){e.getConfig('autoTrack').appShow&&e._track(EventType.APPSHOW);};}function appHide(t){return function(){let e;t.getConfig('autoTrack').appHide&&(e=t.getConfig('launchInfo'), t._track(EventType.APPHIDE, {$dr:-1, $share_oid:e&&e.query.qda_shareopenid}));};}function getUrl(){let e=getCurrentPages();if(e.length){let t=e[e.length-1], n=t.route, i=t.options||{}, r='';for(let a in i){i.hasOwnProperty(a)&&(''===r?r='?'+a+'='+i[a]:r+='&'+a+'='+i[a]);}return''+n+r;}return'';}function getPath(){let e=getCurrentPages();return e.length?e[e.length-1].route:'';}!function(e){e.PAGESHOW='$MPPageShow', e.SHARE='$MPShare', e.APPSHOW='$MPShow', e.APPHIDE='$MPHide', e.LAUNCH='$MPLaunch', e.PAGEHIDE='$MPPageHide';}(EventType=EventType||{});let pid, showTime=0;function pageShow(n){return function(){showTime=+new Date;let e=n.getConfig('autoTrack').pageShow;n.setConfig('pageTitle', this.data&&this.data.qdt&&this.data.qdt.title||''), n.getConfig('pageTitle')||''||n.setConfig('pageTitle', this.config&&this.config.navigationBarTitleText||'');let t=n.getConfig('screenWidth')+'*'+n.getConfig('screenHeight')+n.getConfig('appid');pid=createQid(t), n.setConfig('pid', pid), e&&sendPageShowEvent(n);};}function sendPageShowEvent(e, t){let n=getUrl();getPath();e.setConfig('pageUrl', n);let i=e.getConfig('launchInfo');e._track(EventType.PAGESHOW, __assign({$share_oid:i&&i.query.qda_shareopenid, $page_id:pid, $share_qid:i&&i.query.qda_shareqid}, t));}function pageShare(e, s){function n(e){let t, n, i, r;s.getConfig('autoTrack').share&&(s.setConfig('pageUrl', getUrl()), t=s.getConfig('launchInfo'), n=e.path||'', i=parseInt(getQuery(n, 'qda_sharelevel')), r=getQuery(n, 'qda_shareid'), s._track(EventType.SHARE, {$share_oid:t&&t.query.qda_shareopenid, $share_qid:t&&t.query.qda_shareqid, $page_id:pid, $share_id:r, $share_level:i, $share_url_path:n}));}function i(e){e=e||{};var t=s.getConfig('openid'), n=s.getConfig('launchInfo'), i=n&&n.query||{}, r=deleteQuery(r=e.path||getUrl(), 'qda_shareopenid');r=deleteQuery(r, 'channel');let a=parseInt(getQuery(r, 'qda_sharelevel'));r=deleteQuery(r, 'qda_sharelevel'), r=setQuery(r=deleteQuery(r, 'qda_shareid'), 'qda_shareid', createQid(s.getConfig('appid'))), r=setQuery(r, 'qda_sharelevel', isNaN(a)?1:a+1), r=setQuery(r, 'qda_shareqid', s.getConfig('qid')), e.path=setQuery(r, 'qda_shareopenid', t);let o=i.tar_channel;return o&&(e.path=setQuery(e.path, 'channel', o)), e;}let r;e.onShareAppMessage?(r=e.onShareAppMessage, e.onShareAppMessage=function(e){let t=i(r.call(this, e));return n.call(this, t), t;}):e.onShareAppMessage=function(){let e=i({});return n.call(this, e), {};};}function setQuery(e, t, n){return-1<e.indexOf('?')?e+='&':e+='?', e+(encodeURIComponent(t)+'='+encodeURIComponent(n.toString()));}function getQuery(e, t){for(var n, i=new RegExp('(?:&|\\?)?'+escapeReg(encodeURIComponent(t))+'=([^&]*)(?:&|$)', 'g'), r='';n=i.exec(e);){if(n[1]){r=decodeURIComponent(n[1]);break;}}return r;}function deleteQuery(e, t){let n=new RegExp('(&|\\?)?'+escapeReg(encodeURIComponent(t))+'=([^&]*)(?:&|$)', 'g');return function(e){let t=e.charAt(e.length-1);'&'!==t&&'?'!==t||(e=e.slice(0, -1));return e;}(e.replace(n, '$1'));}function escapeReg(e){return String(e).replace(new RegExp('([.*+?^=!:${}()|[\\]/\\\\-])', 'g'), '\\$1');}function _sendPageHideEvent(e){e.getConfig('autoTrack').pageHide&&sendPageHideEvent(e);}function sendPageHideEvent(e, t){let n=+new Date-showTime;n>Math.pow(10, 12)&&(n=0);let i=e.getConfig('launchInfo'), r={$share_oid:i&&i.query.qda_shareopenid, $page_id:pid, $share_qid:i&&i.query.qda_shareqid, $dr:n};e._track(EventType.PAGEHIDE, __assign(__assign({}, r), t));}function pageHide(e, t){let n;e.onHide?(n=e.onHide, e.onHide=function(){n.call(this), _sendPageHideEvent(t);}):e.onHide=function(){_sendPageHideEvent(t);};}function pageUnload(e, t){let n;e.onUnload?(n=e.onUnload, e.onUnload=function(){n.call(this), _sendPageHideEvent(t);}):e.onUnload=function(){_sendPageHideEvent(t);};}let VERSION='1.2.0';localStorage.init();let QDTracker={initting:!1, initQue:[], config:{debug:!1, disableCache:!1, apiHost:'https://v.qidian.qq.com', version:VERSION, appid:'', kfuin:'', openid:'', appkey:'', isGetSystemInfoComplete:!1, useOid:0, qid:'', type:1, autoTrack:{appLaunch:!0, appShow:!0, appHide:!0, pageShow:!0, pageHide:!0, share:!0}}, init:function(e){void 0===e&&(e={apiHost:'', appid:'', kfuin:'', useOpenId:!1});try{if(e.autoTrack){let t=e.autoTrack;for(let n in t){this.config.autoTrack[n]=t[n];}}this.setConfig('application', e.application), this.config.useOid=Number(e.useOpenId), extend(!0, this.config, e);let i=localStorage.getCache();this.getConfig('disableCache')||extend(!0, this.config, i), log.init(this), queue.init(this);}catch(e){console.log('qidianDA_Error', 'init', e);}}, _initSys:function(){let t, o=this, e=new Promise(function(e){t=e;});return this.getConfig('isGetSystemInfoComplete')&&t&&t(), this.initQue.push(t), this.initting||(this.initting=!0, wx.getNetworkType({success:function(e){o.setConfig('$network_type', e.networkType);}, complete:function(){wx.getSystemInfo({success:function(e){let t, n, i={$manufacturer:e.brand, $model:e.model, $screen_width:Number(e.screenWidth), $screen_height:Number(e.screenHeight), $os:(t=e.platform, 'ios'===(n=t.toLowerCase())?'iOS':'android'===n?'Android':t), $os_version:-1<e.system.indexOf(' ')?e.system.split(' ')[1]:e.system};for(let r in i){o.setConfig(r, i[r]);}let a=o.getConfig('qid');a||(a=randomId().toString(), o.setConfig('qid', a), localStorage.setValue('qid', a), localStorage.save()), o.initQue.forEach(function(e){e();}), o.setConfig('isGetSystemInfoComplete', !0);}, complete:function(){}});}})), e;}, setCommonData:function(e, t){try{let n;t&&(t.da_rpt_type&&this.setRequireData('da_rpt_type', t.da_rpt_type), t.bussid&&this.setRequireData('bussid', t.bussid), t.appkey&&this.setRequireData('appkey', t.appkey), t.unionid&&this.setRequireData('unionid', t.unionid), t.openid&&this.setRequireData('openid', t.openid), t.kfuin&&this.setRequireData('kfuin', t.kfuin), delete(n=__assign({}, t)).openid, delete n.unionid, delete n.kfuin, delete n.appkey, delete n.bussid, delete n.da_rpt_type, this.setConfig('_outerData', n)), e&&this.setConfig('_commonData', e);}catch(e){console.log('qidianDA_Error', 'setCommonData', e);}}, canSend:function(){return!(!this.getConfig('kfuin')&&!this.getConfig('appkey'))&&(!(!this.getConfig('kfuin')&&!this.getConfig('appkey'))&&(0===this.getConfig('useOid')||!!this.getConfig('openid')));}, setRequireData:function(e, t){this.setConfig(e, t), localStorage.setValue(e, t), localStorage.save(), queue.flush();}, setUserInfo:function(e){this.setConfig('userInfo', e);}, getTimeStamp:function(){return Math.floor(new Date/1e3);}, preSend:function(e, t, n){let i=__assign(__assign({}, t), {event:e});queue.send({url:'/events/report', data:i, callback:n});}, getCommonData:function(){let f=this;return new Promise(function(o){let s=f.getConfig('pid')||'', c=f.getConfig('pageTitle')||'', u=f.getConfig('pageUrl')||'';f._initSys().then(function(){let t={};['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term'].forEach(function(e){t['$'+e]=f.getConfig(e), t['$latest_'+e]=f.getConfig('$latest_'+e);});let e=f.getConfig('launchInfo'), n=f.getConfig('_commonData'), i=f.getConfig('_outerData'), r=__assign(__assign({}, i), {properties:__assign({$page_id:s||f.getConfig('pid')||'', $appid:f.getConfig('appid'), $sdk_type:'wxminiprogram', $url:u||f.getConfig('pageUrl')||'', $title:c||f.getConfig('pageTitle')||'', $sdk_version:f.getConfig('version'), $scene:e&&e.scene, $referrer:e&&JSON.stringify(e.referrerInfo), $is_first_day:f.getConfig('$is_first_day'), $network_type:f.getConfig('$network_type'), $os_version:f.getConfig('$os_version'), $sh:f.getConfig('$screen_height'), $sw:f.getConfig('$screen_width'), $application:f.getConfig('application')}, t), qid:f.getConfig('qid'), time:f.getTimeStamp()});if(f.getConfig('kfuin')&&(r.kfuin=f.getConfig('kfuin')), f.getConfig('appkey')&&(r.appkey=f.getConfig('appkey')), f.getConfig('openid')&&(r.account=JSON.stringify({bussid:f.getConfig('bussid'), wechat:{openid:f.getConfig('openid'), appid:f.getConfig('appid'), unionid:f.getConfig('unionid')}})), n){for(let a in n){r.properties[a]=n[a];}}o(r);});});}, _track:function(n, i){let r=this;i=i||{}, this.getCommonData().then(function(e){let t=__assign(__assign({}, i), e.properties);r.preSend(n, __assign(__assign({}, e), {properties:t, type:'track'}));});}, track:function(e, t){try{switch(t=t||{}, e){case EventType.PAGEHIDE:sendPageHideEvent(this, t);break;case EventType.PAGESHOW:sendPageShowEvent(this, t);break;default:this._track(e, t);}}catch(e){console.log('qidianDA_Error', 'track', e);}}, getIDs:function(){return{qid:this.getConfig('qid'), pid:this.getConfig('pid'), openid:this.getConfig('openid'), unionid:this.getConfig('unionid')};}, send:function(_, e, y){let t, v=this, C=0, n={type:this.getConfig('da_rpt_type')||'track'}, m=__assign(__assign(__assign({}, e), n), {properties:JSON.stringify(__assign(__assign({}, e.properties), {$application:this.getConfig('application')}))});!m.account&&this.getConfig('openid')&&(t={bussid:this.getConfig('bussid'), wechat:{appid:this.getConfig('appid'), openid:this.getConfig('openid'), unionid:this.getConfig('unionid')}}, m.account=JSON.stringify(t));var S=function(){let e, t=v.getConfig('apiMethod'), n=v.getConfig('encryptMode'), i='GET';if('post'===t){i='POST', _='/events/trace';let r=m.appkey, a=m.kfuin, o=__rest(m, ['appkey', 'kfuin']), s=__assign(__assign({}, o), {properties:JSON.parse(o.properties), account:JSON.parse(o.account||'{}')}), c=JSON.stringify(s||{}), u=3;if(n&&'default'!==n||(c=Base64.encode(encodeURIComponent(JSON.stringify(s))), u=1), 'aes'===n){let f=getAes(), d=(r+a).substring(0, 16);if(d.length<16){for(let h=16-d.length, g=0;g<h;g++){d+='0';}}let p=f?f.enc.Utf8.parse(d):'', l={iv:p, mode:f?f.mode.CBC:'', padding:f?f.pad.Pkcs7:''};e=Base64.encode(encodeURIComponent(JSON.stringify(s))), c=f.AES.encrypt(e, p, l).ciphertext.toString(f.enc.Base64), u=2;}m={data:c, appkey:String(r), kfuin:Number(a), ext:u};}wx.request({url:v.getConfig('apiHost')+_, method:i, header:{'content-type':'GET'===i?'application/x-www-form-urlencoded':'text/plain'}, data:m, success:function(e){log.info(e), y&&y();}, fail:function(e){log.error(e), C<3&&(C++, S());}});};S();}, getUserInfoP:function(){let n=this, i=this;return new Promise(function(t){let e=n.getConfig('userInfo');e&&t(e), wx.getUserInfo({lang:'zh_CN', success:function(e){i.setConfig('userInfo', e.userInfo), t(e.userInfo);}, fail:function(){t();}});});}, getConfig:function(e){return this.config[e];}, setConfig:function(e, t){this.config[e]=t;}}, app=App, page=Page;App=function(e){eventProxy(e, 'onLaunch', appLaunch(QDTracker)), eventProxy(e, 'onShow', appShow(QDTracker)), eventProxy(e, 'onHide', appHide(QDTracker)), app(e);}, Page=function(e){eventProxy(e, 'onShow', pageShow(QDTracker)), pageShare(e, QDTracker), pageHide(e, QDTracker), pageUnload(e, QDTracker), page(e);}
export default QDTracker;
